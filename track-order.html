<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Track Your Order | Blackwear</title>
<style>
body{margin:0;padding:20px;background:#0f0f0f;color:#fff;font-family:system-ui}
.container{max-width:900px;margin:auto;background:#141414;border-radius:14px;padding:20px}
h1,h2,p{margin:0 0 10px;color:#ff7f00}
input,button{width:100%;padding:12px;margin-top:8px;border-radius:10px;border:none}
button{background:#ff7f00;color:#000;font-weight:bold;cursor:pointer}
.error{background:red;padding:10px;margin-top:10px;border-radius:10px;color:#fff}
</style>
</head>
<body>

<div class="container">
  <h1>Track Your Order</h1>
  <p>Enter your Order ID to see the current status.</p>
  <input id="orderIdInput" placeholder="Order ID">
  <button id="trackBtn">Track Order</button>
  <div id="orderResult"></div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>

<script>
firebase.initializeApp({
  apiKey: "AIzaSyBy0bIMp1ORV0UfLgKlxyr2V-I9mJjFb6o",
  authDomain: "blackwear-14a31.firebaseapp.com",
  projectId: "blackwear-14a31"
});

const db = firebase.firestore();
const el = id => document.getElementById(id);

async function loadOrder(orderId){
  try {
    const doc = await db.collection("orders").doc(orderId).get();
    if(!doc.exists){
      el("orderResult").innerHTML = '<div class="error">Order not found</div>';
      return;
    }

    const data = doc.data();
    el("orderResult").innerHTML = `
      <h2>Order ID: ${doc.id}</h2>
      <p><strong>Status:</strong> ${data.orderStatus}</p>
      <p><strong>Delivery:</strong> ${data.deliveryStatus}</p>
      <p><strong>Total:</strong> ₦${data.total.toLocaleString()}</p>
      <p><strong>Payment Method:</strong> ${data.payment.method}</p>
      <p><strong>Payment Status:</strong> ${data.payment.status}</p>
      <h3>Items:</h3>
      ${data.items.map(i=>`<p>${i.productName || i.name} - ₦${Number(i.price).toLocaleString()}</p>`).join('')}
    `;
  } catch(err){
    console.error(err);
    el("orderResult").innerHTML = '<div class="error">Error loading order</div>';
  }
}

el("trackBtn").onclick = () => {
  const id = el("orderIdInput").value.trim();
  if(!id) return alert("Enter Order ID");
  loadOrder(id);
};

// Auto-load if ID in URL
const params = new URLSearchParams(window.location.search);
const urlId = params.get("id");
if(urlId) el("orderIdInput").value = urlId; loadOrder(urlId);
</script>

</body>
</html>
